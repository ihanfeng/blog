title: ThinkPHP笔记2-配置
date: 2013-12-12 14:18:43
categories: ThinkPHP
tags: [ThinkPHP,配置]
---
ThinkPHP在项目配置上面创造了自己独有的分层配置模式，其配置层次体现在：

	惯例配置->项目配置->调试配置->分组配置->扩展配置->动态配置

以上是配置文件的加载顺序，因为后面的配置会覆盖之前的同名配置（在没有生效的前提下），所以优先顺序从右到左。系统的配置参数是通过静态变量全局存取的，存取方式简单高效。
<!-- more -->
##**配置格式**

ThinkPHP框架中所有配置文件的定义格式均采用返回PHP数组的方式，格式为：
{%codeblock lang:php%}
//项目配置文件
 return array(
    'DEFAULT_MODULE'     => 'Index', //默认模块
    'URL_MODEL'          => '2', //URL模式
    'SESSION_AUTO_START' => true, //是否开启session
    //更多配置参数
    //...
 );
 {%endcodeblock%}

 配置参数不区分大小写（因为无论大小写定义都会转换成小写）,建议保持大写定义配置参数的规范。

##**惯例配置**
惯例重于配置是系统遵循的一个重要思想，系统内置有一个惯例配置文件（位于系统目录下面的Conf\convention.php），按照大多数的使用对常用参数进行了默认配置。所以，对于应用项目的配置文件，往往只需要配置和惯例配置不同的或者新增的配置参数，如果你完全采用默认配置，甚至可以不需要定义任何配置文件。
惯例配置文件会被系统自动加载，无需在项目中进行加载。

##**项目配置**
项目配置文件是最常用的配置文件，项目配置文件位于项目的配置文件目录Conf下面，文件名是config.php。
在项目配置文件里面除了添加内置的参数配置外，还可以额外添加项目需要的配置参数。

##**调试配置**

新版增强了调试模式的配置文件，在开启调试模式的状态下，可以给项目设置不同的应用状态，并加载不同的项目配置文件，但是无论如何，都会首先导入框架默认的调试模式配置文件，该文件位于系统目录的Conf\debug.php。
通常情况下，调试配置文件里面可以进行一些开发模式所需要的配置。例如，配置额外的数据库连接用于调试，开启日志写入便于查找错误信息、开启页面Trace输出更多的调试信息等等。
注意：3.0版本的调试模式默认没有开启运行时间显示和页面Trace显示，需要自行开启，并且建议调试模式只开启页面Trace即可，新版的页面Trace显示信息已经包含了运行时间显示。
如果没有配置应用状态，系统默认则默认为debug状态，也就是说默认的配置参数是：

	'APP_STATUS' => 'debug', //应用调试模式状态

如果检测到项目的配置目录中有存在debug.php文件，则会自动加载该配置文件，并且和系统项目配置文件以及系统调试配置文件合并，也就是说，debug.php配置文件只需要配置和项目配置文件以及系统调试配置文件不同的参数或者新增的参数。
如果想在调试模式下面增加应用状态，例如测试状态，则可以在项目配置文件中改变设置如下：

	'APP_STATUS' => 'test', //应用调试模式状态

这样的话，系统会自动尝试加载项目配置目录下面的test.php 配置文件，可以在test配置文件中改变相关设置，例如改变测试数据库的连接信息等等。
由于调试模式没有任何缓存，因此涉及到较多的文件IO操作和模板实时编译，所以在开启调试模式的情况下，性能会有一定的下降，但不会影响部署模式的性能。
注意：一旦关闭调试模式，项目的调试配置文件即刻失效。
##**分组配置**


##**读取配置**

定义了配置文件之后，可以使用系统提供的C方法（如果觉得比较奇怪的话，可以借助Config单词来帮助记忆）来读取已有的配置：
C('参数名称')//获取已经设置的参数值

##**动态配置**
之前的方式都是通过预先定义配置文件的方式，而在具体的Action方法里面，我们仍然可以对某些参数进行动态配置，主要是指那些还没有被使用的参数。 
设置新的值：

	C('参数名称','新的参数值');

例如，我们需要动态改变数据缓存的有效期的话，可以使用

	C('DATA_CACHE_TIME','60');

##**扩展配置**




